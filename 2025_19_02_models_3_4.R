# model_corr_magnitude_variability
# with 3 and 4 measurement variables
model_1_high_low <- '
                xi_1 =~ 0.8*x11 + 0.8*x12 + 0.8*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 1*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_1_high_high <- '
                xi_1 =~ 0.9*x11 + 0.9*x12 + 0.9*x13
                xi_2 =~ 0.3*x21 + 0.3*x22 + 0.3*x23 + 0.3*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 1*xi_2
                xi_2 ~~ 1*xi_2
              ' 


model_1_low_high <- '
                xi_1 =~ 0.4*x11 + 0.4*x12 + 0.4*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 1*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_1_low_low <- '
                xi_1 =~ 0.3*x11 + 0.3*x12 + 0.3*x13
                xi_2 =~ 0.4*x21 + 0.4*x22 + 0.4*x23 + 0.4*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 1*xi_2
                xi_2 ~~ 1*xi_2
              ' 

######################################################
model_05_high_low <- '
                xi_1 =~ 0.8*x11 + 0.8*x12 + 0.8*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.5*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_05_high_high <- '
                xi_1 =~ 0.9*x11 + 0.9*x12 + 0.9*x13
                xi_2 =~ 0.3*x21 + 0.3*x22 + 0.3*x23 + 0.3*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.5*xi_2
                xi_2 ~~ 1*xi_2
              ' 


model_05_low_high <- '
                xi_1 =~ 0.4*x11 + 0.4*x12 + 0.4*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.5*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_05_low_low <- '
                xi_1 =~ 0.3*x11 + 0.3*x12 + 0.3*x13
                xi_2 =~ 0.4*x21 + 0.4*x22 + 0.4*x23 + 0.4*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.5*xi_2
                xi_2 ~~ 1*xi_2
              ' 
######################################################
model_07_high_low <- '
                xi_1 =~ 0.8*x11 + 0.8*x12 + 0.8*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.7*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_07_high_high <- '
                xi_1 =~ 0.9*x11 + 0.9*x12 + 0.9*x13
                xi_2 =~ 0.3*x21 + 0.3*x22 + 0.3*x23 + 0.3*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.7*xi_2
                xi_2 ~~ 1*xi_2
              ' 


model_07_low_high <- '
                xi_1 =~ 0.4*x11 + 0.4*x12 + 0.4*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.7*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_07_low_low <- '
                xi_1 =~ 0.3*x11 + 0.3*x12 + 0.3*x13
                xi_2 =~ 0.4*x21 + 0.4*x22 + 0.4*x23 + 0.4*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.7*xi_2
                xi_2 ~~ 1*xi_2
              ' 
########################################################
model_08_high_low <- '
                xi_1 =~ 0.8*x11 + 0.8*x12 + 0.8*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.8*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_08_high_high <- '
                xi_1 =~ 0.9*x11 + 0.9*x12 + 0.9*x13
                xi_2 =~ 0.3*x21 + 0.3*x22 + 0.3*x23 + 0.3*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.8*xi_2
                xi_2 ~~ 1*xi_2
              ' 


model_08_low_high <- '
                xi_1 =~ 0.4*x11 + 0.4*x12 + 0.4*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.8*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_08_low_low <- '
                xi_1 =~ 0.3*x11 + 0.3*x12 + 0.3*x13
                xi_2 =~ 0.4*x21 + 0.4*x22 + 0.4*x23 + 0.4*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.8*xi_2
                xi_2 ~~ 1*xi_2
              ' 
########################################################
model_09_high_low <- '
                xi_1 =~ 0.8*x11 + 0.8*x12 + 0.8*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.9*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_09_high_high <- '
                xi_1 =~ 0.9*x11 + 0.9*x12 + 0.9*x13
                xi_2 =~ 0.3*x21 + 0.3*x22 + 0.3*x23 + 0.3*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.9*xi_2
                xi_2 ~~ 1*xi_2
              ' 


model_09_low_high <- '
                xi_1 =~ 0.4*x11 + 0.4*x12 + 0.4*x13
                xi_2 =~ 0.7*x21 + 0.7*x22 + 0.7*x23 + 0.7*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.9*xi_2
                xi_2 ~~ 1*xi_2
              ' 

model_09_low_low <- '
                xi_1 =~ 0.3*x11 + 0.3*x12 + 0.3*x13
                xi_2 =~ 0.4*x21 + 0.4*x22 + 0.4*x23 + 0.4*x24
                x11 ~~ 1*x11 + 0*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x12 ~~ 1*x12 + 0*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x13 ~~ 1*x13 + 0*x21 + 0*x22 + 0*x23 + 0*x24
                x21 ~~ 1*x21 + 0*x22 + 0*x23 + 0*x24
                x22 ~~ 1*x22 + 0*x23 + 0*x24
                x23 ~~ 1*x23 + 0*x24
                x24 ~~ 1*x24
              
                xi_1 ~~ 1*xi_1 + 0.9*xi_2
                xi_2 ~~ 1*xi_2
              ' 
########################################################



model_list <- list("1_high_low" = model_1_high_low, 
                   "1_high_high" = model_1_high_high, 
                   "1_low_high" = model_1_low_high, 
                   "1_low_low" = model_1_low_low, 
                   "05_high_low" = model_05_high_low, 
                   "05_high_high" = model_05_high_high , 
                   "05_low_high" = model_05_low_high, 
                   "05_low_low" = model_05_low_low, 
                   "07_high_low" = model_07_high_low, 
                   "07_high_high" = model_07_high_high , 
                   "07_low_high" = model_07_low_high, 
                   "07_low_low" = model_07_low_low,
                   "08_high_low" = model_08_high_low, 
                   "08_high_high" = model_08_high_high , 
                   "08_low_high" = model_08_low_high, 
                   "08_low_low" = model_08_low_low,
                   "09_high_low" = model_09_high_low, 
                   "09_high_high" = model_09_high_high , 
                   "09_low_high" = model_09_low_high, 
                   "09_low_low" = model_09_low_low)

coefs <- c(seq(-1,1,0.1))
coefs
loadings <- combn(coefs, 2)
loadings
errorvar <- (1-loadings^2)
errorvar
simModels <- foreach(i = 1:ncol(loadings)) %do% {
  simCommonFactor <- paste(paste("xi =~ ",loadings[1,i],"*x1 + ",loadings[2,i],"*x2 + 1*x3 + 1*x4"),"\n",
                           paste("xi ~~ 1*xi"),"\n",
                           paste("x1 ~~",errorvar[1,i],"*x1 + 0*x2 + 0*x3 + 0*x4"),"\n",
                           paste("x2 ~~",errorvar[2,i],"*x2 + 0*x3 + 0*x4"),"\n",
                           paste("x3 ~~ 1*x3 + 0*x4"),"\n",
                           paste("x4 ~~ 1*x4"),"\n")
  return(simCommonFactor)
}

